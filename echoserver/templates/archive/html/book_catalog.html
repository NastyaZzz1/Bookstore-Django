{% load static %}

<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="{% static '/css/styles_catalog.css' %}">
    <title>BOOKSTORE</title>
  </head>
  <body style="font-family: sans-serif">
    <header>
        <h1>Book catalog</h1>
        {% if user.is_authenticated %}
        <li> <a >{{ user.username }}</a> | <a href="{% url 'logout' %}">Выйти</a></li>
        {% else %}
        <button type="submit" class="main-submit-white" onclick="window.location.href='{% url 'login' %}';">Войти<img src=" {% static 'svg/arrow-left-white.svg' %} " class="submit-arrow-color" width="17" height="17"></button>
        {% endif %}
    </header>
    <main>

      <div class="count_and_add">
        <p class="count">Книг в каталоге: <span>{{ count }}</span></p>
        {% if user.is_authenticated %}
        <a href="{% url 'add_item' %}" class="add_item_but">Добавить книгу <b>+</b></a>
        {% endif %}
      </div>

      <div class="items">
        {% for book in page_obj %}
        <div class="item">
          <p style="line-height: 0.5; font-size: 1.5rem">{{ book.name }}</p>
          <h4 style="line-height: 0.5">{{ book.author }}</h4>
          <p style="line-height: 0.5">{{ book.genre }}</p>
          <p style="line-height: 0.5" class="cost">{{ book.cost }} ₽</p>
          
          {% if user.is_authenticated and user.is_superuser%}
          <div class="but_change_del">
            <a href="{% url 'change_item' book.id %}" class="change_but">Изменить</a>

            <form action="{% url 'delete_item' book.id %}" method="post" onsubmit="return confirm('Вы уверены, что хотите удалить этот элемент?');">
              {% csrf_token %}
              <button type="submit">Удалить</button>
            </form>
          </div>
          {% endif %}

        </div>
        {% endfor %}
      </div>

      <div class="pagination">
        <ul class="pagination">
          {% if page_obj.has_previous %}
            <li class="page-item"><a class="page-link hand" href="?page={{ page_obj.previous_page_number }}">← Предыдущая страница</a></li>
          {% endif %}
          
          {% for i in page_obj.paginator.page_range %}
            {% if i >= page_obj.number|add:'-1' and i <= page_obj.number|add:'1' %}
              {% if i == page_obj.number %}
                <li class="page-item"><span class="page-link" id="active">{{ i }}</span></li>
              {% else %}
                <li class="page-item"><a class="page-link" id="notactive" href="?page={{ i }}">{{ i }}</a></li>
              {% endif %}
            {% endif %}
          {% endfor %}
            
          {% if page_obj.has_next %}
            <li class="page-item"><a class="page-link hand" href="?page={{ page_obj.next_page_number }}">Следующая страница →</a></li>
          {% endif %}
        </ul>
      </div>

    </main>
  </body>
</html>